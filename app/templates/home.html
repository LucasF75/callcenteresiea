<!doctype html>
<html>
<head>
  <title>ReadList</title>
</head>
<body>
   <h1>ReadList üìö</h1>
  <form action="{{ url_for('main.search') }}" method="POST">
    <input type="text" name="query" placeholder="Rechercher un livre...">
    <input type="submit" value="Rechercher">
  </form>


{% if random_quote %}
  <blockquote style="font-style: italic; margin: 20px 0;">
    ‚Äú{{ random_quote }}‚Äù
  </blockquote>
{% endif %}


<h2>Let's discover new genres...</h2>
<form action="{{ url_for('main.search_by_genre') }}" method="POST">
  <select name="genre">
    <option value="Science Fiction">Science Fiction</option>
    <option value="Romance">Romance</option>
    <option value="Mystery">Mystery</option>
    <option value="Fantasy">Fantasy</option>
    <option value="History">History</option>
    <option value="Biography">Biography</option>
    <option value="Self-Help">Self-Help</option>
    <option value="Philosophy">Philosophy</option>
    <!-- Tu peux ajouter plus de genres ici -->
  </select>
  <input type="submit" value="Chercher">
</form>



  <h2>RECOMMENDATION</h2>
  {% if recommendations %}
    <ul>
      {% for book in recommendations %}
        <li>
          <a href="{{ url_for('main.book_detail', book_id=book.id) }}">
            {% if book.thumbnail %}
              <img src="{{ book.thumbnail }}" alt="Couverture" style="height: 100px;">
            {% endif %}
            <p>{{ book.title }}</p>
            <p>Auteurs : {{ book.authors | join(', ') }}</p>
          </a>
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p>Aucune recommandation pour le moment.</p>
  {% endif %}



  <h2>RECENT</h2>
<div id="recent-books-container">
    {% if recent_books %}
  <ul>
    {% for book in recent_books %}
      <li>
        <a href="{{ url_for('main.book_detail', book_id=book.id) }}">
          {% if book.thumbnail %}
            <img src="{{ book.thumbnail }}" alt="Couverture" style="height: 100px;">
          {% endif %}
          <p>{{ book.title }}</p>
          <p>Auteurs : {{ book.authors | join(', ') }}</p>
        </a>
      </li>
    {% endfor %}
  </ul>
{% else %}
  <p>Vous n'avez pas encore consult√© de livres.</p>
{% endif %}
</div>






  <a href="{{ url_for('main.profile') }}">Mon profil</a> <br>






<script>
  async function fetchRecentBooks() {
    try {
      const response = await fetch('/api/recent-books');
      if (!response.ok) {
        console.error('Erreur lors de la r√©cup√©ration des livres r√©cents');
        return;
      }
      const books = await response.json();

      const container = document.getElementById('recent-books-container');
      container.innerHTML = ''; // Vide le container

      books.forEach(book => {
        const bookDiv = document.createElement('div');
        bookDiv.classList.add('recent-book');

        bookDiv.innerHTML = `
          <a href="/book/${book.id}">
            <img src="${book.thumbnail || ''}" alt="Couverture" style="width: 80px; height: auto;">
            <p>${book.title}</p>
            <p><small>${book.authors.join(', ')}</small></p>
          </a>
        `;

        container.appendChild(bookDiv);
      });
    } catch (error) {
      console.error('Erreur:', error);
    }
  }

  window.addEventListener('load', fetchRecentBooks);

  // Aussi g√©rer le cas du bouton "Pr√©c√©dent" du navigateur
  window.addEventListener('pageshow', function(event) {
    if (event.persisted) {
      fetchRecentBooks();
    }
  });
</script>


</body>
</html>
